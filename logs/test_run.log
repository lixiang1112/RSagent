/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/langchain_core/_api/deprecation.py:117: LangChainDeprecationWarning: The class `langchain_community.chat_models.openai.ChatOpenAI` was deprecated in langchain-community 0.0.10 and will be removed in 0.2.0. An updated version of the class exists in the langchain-openai package and should be used instead. To use it run `pip install -U langchain-openai` and import as `from langchain_openai import ChatOpenAI`.
  warn_deprecated(
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
Initializing RSChatGPT, load_dict={'ImageCaptioning': 'cuda:0', 'SceneClassification': 'cuda:0', 'ObjectDetection': 'cuda:0', 'ObjectCounting': 'cuda:0', 'EdgeDetection': 'cpu', 'ChangeDetection': 'cuda:0'}
Initializing ImageCaptioning to cuda:0
ä»æœ¬åœ°è·¯å¾„åŠ è½½æ¨¡å‹: /root/autodl-tmp/blip
Initializing SceneClassification
Initializing SceneClassification
Loading model from: /root/autodl-tmp/tool_models/Res34_AID_best.pth
Loading YOLOv5 model from: /root/autodl-tmp/tool_models/yolov5_best.pt
Loading YOLOv5 model from: /root/autodl-tmp/tool_models/yolov5_best.pt
Initializing Edge Detection Function....
Initializing Image2Canny
Initializing Change Detection Function....
æ­£åœ¨åˆå§‹åŒ–å˜åŒ–æ£€æµ‹æ¨¡å‹åˆ°è®¾å¤‡ cuda:0...
åŠ è½½å˜åŒ–æ£€æµ‹æ¨¡å‹...
loading the resnet50 pretrained weight from local .....
loading the resnet50 pretrained weight from local .....
å˜åŒ–æ£€æµ‹æ¨¡å‹åŠ è½½æˆåŠŸï¼
åŠ è½½ CLIP æ¨¡å‹...
CLIP æ¨¡å‹åŠ è½½æˆåŠŸï¼
å˜åŒ–æ£€æµ‹æ¨¡å—åˆå§‹åŒ–å®Œæˆï¼
All the Available Functions: {'ImageCaptioning': <rschatgpt.ImageCaptioning object at 0x7fc4dbd2eac0>, 'SceneClassification': <rschatgpt.SceneClassification object at 0x7fc4dbd2ee20>, 'ObjectDetection': <rschatgpt.ObjectDetection object at 0x7fc4d7a326a0>, 'ObjectCounting': <rschatgpt.ObjectCounting object at 0x7fc4d8ccad30>, 'EdgeDetection': <rschatgpt.EdgeDetection object at 0x7fc4ce678400>, 'ChangeDetection': <rschatgpt.ChangeDetection object at 0x7fc4ce56e820>}
å¼€å§‹æµ‹è¯•ï¼Œå…± 6 ä¸ªé—®é¢˜
====================================================================================================

[1/6] æµ‹è¯•é—®é¢˜ ID=121
é—®é¢˜: å¯¹æ¯”è¿™ä¸¤ä¸ªæ—¶æœŸçš„å½±åƒï¼Œæ‰¾å‡ºå“ªäº›åŒºåŸŸå‘ç”Ÿäº†å˜åŒ–ã€‚
Ground Truth: ChangeDetection

Processed ImageCaptioning, Input Image: result/q121_ChangeDetection_before.png, Output Text: A satellite image of a satellite image of the site of the ancient city of person

Processed ImageCaptioning, Input Image: result/q121_ChangeDetection_before.png, Output Text: A satellite image of a satellite image of the site of the ancient city of person


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Change Detection On Image Pair
Action Input: result/q121_ChangeDetection_before.png,result/q121_ChangeDetection_after.png[0mChange detection completed. Changed area: 6.69% (4386/65536 pixels). Result saved to result/74d5_change_detection_q121.png

Observation: [38;5;200m[1;3mChange detection completed. Changed area: 6.69% (4386/65536 pixels). Result saved to result/74d5_change_detection_q121.png. Output: result/74d5_change_detection_q121.png[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: Change detection completed. The changed area is 6.69% (4386/65536 pixels). The result is saved to result/74d5_change_detection_q121.png.[0m

[1m> Finished chain.[0m
å®é™…è°ƒç”¨: ChangeDetection
ç»“æœ: âœ“ æ­£ç¡®
å½“å‰è¿›åº¦: 1/6, æ­£ç¡®ç‡: 100.00%

[2/6] æµ‹è¯•é—®é¢˜ ID=122
é—®é¢˜: å¸®æˆ‘æŠŠè¿™å¼ å›¾é‡Œçš„è¾¹ç¼˜è½®å»“å…¨éƒ¨æå–å‡ºæ¥ã€‚
Ground Truth: EdgeDetection

Processed ImageCaptioning, Input Image: result/q122_EdgeDetection.png, Output Text: A satellite image of an aerial view of the area where the person was found

Processed ImageCaptioning, Input Image: result/q122_EdgeDetection.png, Output Text: A satellite image of an aerial view of the area where the person was found


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Edge Detection On Image
Action Input: result/q122_EdgeDetection.png[0m
Processed Image2Canny, Input Image: result/q122_EdgeDetection.png, Output Text: result/a8e2_edge_q122.png

Observation: [33;1m[1;3mresult/a8e2_edge_q122.png[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: The edge contours of the image have been successfully extracted and saved as result/a8e2_edge_q122.png.[0m

[1m> Finished chain.[0m
å®é™…è°ƒç”¨: EdgeDetection
ç»“æœ: âœ“ æ­£ç¡®
å½“å‰è¿›åº¦: 2/6, æ­£ç¡®ç‡: 100.00%

[3/6] æµ‹è¯•é—®é¢˜ ID=123
é—®é¢˜: è¯·æè¿°ä¸€ä¸‹è¿™å¼ å«æ˜Ÿå›¾åƒçš„ä¸»è¦å†…å®¹æ˜¯ä»€ä¹ˆã€‚
Ground Truth: ImageCaptioning

Processed ImageCaptioning, Input Image: result/q123_ImageCaptioning.png, Output Text: A satellite image of a map of the area

Processed ImageCaptioning, Input Image: result/q123_ImageCaptioning.png, Output Text: A satellite image of a map of the area


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mAI: I will start by using the "Get Photo Description" tool to understand the main content of the satellite image. 

Thought: Do I need to use a tool? Yes
Action: Get Photo Description
Action Input: result/q123_ImageCaptioning.png[0m

[1m> Finished chain.[0m
å®é™…è°ƒç”¨: Unknown
ç»“æœ: âœ— é”™è¯¯
æ–‡æœ¬ç»“æœå·²ä¿å­˜åˆ°: result/q123_ImageCaptioning_result.txt
å½“å‰è¿›åº¦: 3/6, æ­£ç¡®ç‡: 66.67%

[4/6] æµ‹è¯•é—®é¢˜ ID=124
é—®é¢˜: ç»Ÿè®¡ä¸€ä¸‹å½±åƒä¸­æ€»å…±æœ‰å¤šå°‘ä¸ªç›®æ ‡ç‰©ä½“ã€‚
Ground Truth: ObjectCounting

Processed ImageCaptioning, Input Image: result/q124_ObjectCounting.png, Output Text: A satellite image of a satellite image of the site of the person's grave

Processed ImageCaptioning, Input Image: result/q124_ObjectCounting.png, Output Text: A satellite image of a satellite image of the site of the person's grave


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Count object
Action Input: result/q124_ObjectCounting.png, A satellite image of a satellite image of the site of the person's grave[0m
Processed Object Counting, Input Image: result/q124_ObjectCounting.png, Output text:  A satellite image of a satellite image of the site of the person's grave is not a supported category for the model.

Observation: [36;1m[1;3m A satellite image of a satellite image of the site of the person's grave is not a supported category for the model.[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Get Photo Description
Action Input: result/q124_ObjectCounting.png[0m
Processed ImageCaptioning, Input Image: result/q124_ObjectCounting.png, Output Text: A satellite image of a satellite image of the site of the person's grave

Processed ImageCaptioning, Input Image: result/q124_ObjectCounting.png, Output Text: A satellite image of a satellite image of the site of the person's grave

Observation: [36;1m[1;3mA satellite image of a satellite image of the site of the person's grave[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: The image is described as "A satellite image of a satellite image of the site of the person's grave."[0m

[1m> Finished chain.[0m
å®é™…è°ƒç”¨: ObjectCounting
ç»“æœ: âœ“ æ­£ç¡®
æ–‡æœ¬ç»“æœå·²ä¿å­˜åˆ°: result/q124_ObjectCounting_result.txt
å½“å‰è¿›åº¦: 4/6, æ­£ç¡®ç‡: 75.00%

[5/6] æµ‹è¯•é—®é¢˜ ID=125
é—®é¢˜: è¯†åˆ«å›¾ä¸­çš„ç›®æ ‡å¹¶ç”¨è¾¹ç•Œæ¡†æ ‡æ³¨å‡ºæ¥ã€‚
Ground Truth: ObjectDetection

Processed ImageCaptioning, Input Image: result/q125_ObjectDetection.png, Output Text: A satellite image of an aerial view of the site of the proposed development

Processed ImageCaptioning, Input Image: result/q125_ObjectDetection.png, Output Text: A satellite image of an aerial view of the site of the proposed development


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Detect the given object
Action Input: result/q125_ObjectDetection.png, identify and mark the bounding boxes of the objects[0m
Observation: [38;5;200m[1;3mNone[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Detect the given object
Action Input: result/q125_ObjectDetection.png, identify and mark the bounding boxes of the objects[0m
Observation: [38;5;200m[1;3mNone[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: Let's start by identifying and marking the bounding boxes of the objects in the image "result/q125_ObjectDetection.png".[0m

[1m> Finished chain.[0m
å®é™…è°ƒç”¨: ObjectDetection
ç»“æœ: âœ“ æ­£ç¡®
å½“å‰è¿›åº¦: 5/6, æ­£ç¡®ç‡: 80.00%

[6/6] æµ‹è¯•é—®é¢˜ ID=126
é—®é¢˜: åˆ¤æ–­è¿™å¼ é¥æ„Ÿå½±åƒå±äºä»€ä¹ˆç±»å‹çš„åœºæ™¯ã€‚
Ground Truth: SceneClassification
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"

Processed ImageCaptioning, Input Image: result/q126_SceneClassification.png, Output Text: A satellite image of an aerial view of the site of the proposed new school

Processed ImageCaptioning, Input Image: result/q126_SceneClassification.png, Output Text: A satellite image of an aerial view of the site of the proposed new school


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Scene Classification for Remote Sensing Image
Action Input: result/q126_SceneClassification.png[0m
Processed Scene Classification, Input Image: result/q126_SceneClassification.png, Output Scene: result/q126_SceneClassification.png has 85.87% probability being BareLand and 2.64% probability being Playground.

Observation: [33;1m[1;3mresult/q126_SceneClassification.png has 85.87% probability being BareLand and 2.64% probability being Playground.[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: The remote sensing image result/q126_SceneClassification.png is most likely classified as BareLand with a probability of 85.87% and Playground with a probability of 2.64%.[0m

[1m> Finished chain.[0m
å®é™…è°ƒç”¨: SceneClassification
ç»“æœ: âœ“ æ­£ç¡®
æ–‡æœ¬ç»“æœå·²ä¿å­˜åˆ°: result/q126_SceneClassification_result.txt
å½“å‰è¿›åº¦: 6/6, æ­£ç¡®ç‡: 83.33%

====================================================================================================
æµ‹è¯•å®Œæˆ!
æ€»é—®é¢˜æ•°: 6
æ­£ç¡®æ•°é‡: 5
é”™è¯¯æ•°é‡: 1
æ€»æ­£ç¡®ç‡: 83.33%

====================================================================================================
æ¯ä¸ªå·¥å…·ç±»åˆ«çš„æ­£ç¡®ç‡:
====================================================================================================
å·¥å…·åç§°                                 æ€»æ•°       æ­£ç¡®       é”™è¯¯        æ­£ç¡®ç‡
----------------------------------------------------------------------------------------------------
ChangeDetection                       1        1        0    100.00%
EdgeDetection                         1        1        0    100.00%
ImageCaptioning                       1        0        1      0.00%
ObjectCounting                        1        1        0    100.00%
ObjectDetection                       1        1        0    100.00%
SceneClassification                   1        1        0    100.00%
----------------------------------------------------------------------------------------------------
æ€»è®¡                                    6        5        1     83.33%
====================================================================================================

è¯¦ç»†ç»“æœå·²ä¿å­˜åˆ° test_results.csv
è¯¦ç»†æ—¥å¿—å·²ä¿å­˜åˆ° test_details.txt
