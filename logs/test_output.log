/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/langchain_core/_api/deprecation.py:117: LangChainDeprecationWarning: The class `langchain_community.chat_models.openai.ChatOpenAI` was deprecated in langchain-community 0.0.10 and will be removed in 0.2.0. An updated version of the class exists in the langchain-openai package and should be used instead. To use it run `pip install -U langchain-openai` and import as `from langchain_openai import ChatOpenAI`.
  warn_deprecated(
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"

============================================================
å¿«é€Ÿå¯¹æ¯”æµ‹è¯•
æµ‹è¯•æ ·æœ¬æ•°: 3
============================================================

[1/2] æµ‹è¯•åŸºçº¿ï¼ˆæ— ä¼˜åŒ–ï¼‰...

============================================================
å¼€å§‹æµ‹è¯• - åŸºçº¿æ¨¡å¼
æµ‹è¯•æ ·æœ¬æ•°: 3
============================================================

Initializing RSChatGPT, load_dict={'ImageCaptioning': 'cuda:0', 'SceneClassification': 'cuda:0', 'ObjectDetection': 'cuda:0', 'ObjectCounting': 'cuda:0', 'EdgeDetection': 'cpu', 'ChangeDetection': 'cuda:0'}
Initializing ImageCaptioning to cuda:0
ä»æœ¬åœ°è·¯å¾„åŠ è½½æ¨¡å‹: /root/autodl-tmp/blip
Initializing SceneClassification
Initializing SceneClassification
Loading model from: /root/autodl-tmp/tool_models/Res34_AID_best.pth
Loading YOLOv5 model from: /root/autodl-tmp/tool_models/yolov5_best.pt
Loading YOLOv5 model from: /root/autodl-tmp/tool_models/yolov5_best.pt
Initializing Edge Detection Function....
Initializing Image2Canny
Initializing Change Detection Function....
æ­£åœ¨åˆå§‹åŒ–å˜åŒ–æ£€æµ‹æ¨¡å‹åˆ°è®¾å¤‡ cuda:0...
åŠ è½½å˜åŒ–æ£€æµ‹æ¨¡å‹...
loading the resnet50 pretrained weight from local .....
loading the resnet50 pretrained weight from local .....
å˜åŒ–æ£€æµ‹æ¨¡å‹åŠ è½½æˆåŠŸï¼
åŠ è½½ CLIP æ¨¡å‹...
CLIP æ¨¡å‹åŠ è½½æˆåŠŸï¼
å˜åŒ–æ£€æµ‹æ¨¡å—åˆå§‹åŒ–å®Œæˆï¼
All the Available Functions: {'ImageCaptioning': <rschatgpt.ImageCaptioning object at 0x7f932e46c100>, 'SceneClassification': <rschatgpt.SceneClassification object at 0x7f932e46c2b0>, 'ObjectDetection': <rschatgpt.ObjectDetection object at 0x7f932a30c940>, 'ObjectCounting': <rschatgpt.ObjectCounting object at 0x7f932b3910d0>, 'EdgeDetection': <rschatgpt.EdgeDetection object at 0x7f9329733e50>, 'ChangeDetection': <rschatgpt.ChangeDetection object at 0x7f93296862b0>}

[æ ·æœ¬ 1/3] ID=1
  Turn 1 (User): ã€Œè¿™å¼ å«æ˜Ÿå›¾èƒ½å¸®æˆ‘çœ‹ä¸€ä¸‹å—ï¼Ÿã€...

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Text: A satellite image of an aerial view of the house

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Text: A satellite image of an aerial view of the house


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Get Photo Description
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png[0m
Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Text: A satellite image of an aerial view of the house

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Text: A satellite image of an aerial view of the house

Observation: [36;1m[1;3mA satellite image of an aerial view of the house[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: The image you provided is a satellite image showing an aerial view of a house. How can I assist you further with this image?[0m

[1m> Finished chain.[0m
  Turn 3 (User): ä½ èƒ½å¸®æˆ‘çœ‹çœ‹è¿™æ˜¯å“ªæ‹çš„å—ï¼Ÿ...


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Scene Classification for Remote Sensing Image
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png[0m
Processed Scene Classification, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Scene: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png has 70.56% probability being Church and 23.43% probability being Farmland.

Observation: [33;1m[1;3m/root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png has 70.56% probability being Church and 23.43% probability being Farmland.[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: The image you provided has been classified with a 70.56% probability as a Church and a 23.43% probability as Farmland.[0m

[1m> Finished chain.[0m
  Turn 4 (Assistant): âœ— é”™è¯¯
    å®é™…: ['SceneClassification']
    æœŸæœ›: []
  Turn 5 (User): è¿™å¼ å›¾çš„æ¸…æ™°åº¦æ€ä¹ˆæ ·ï¼Ÿ...


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Get Photo Description
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png[0m
Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Text: A satellite image of an aerial view of the house

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Text: A satellite image of an aerial view of the house

Observation: [36;1m[1;3mA satellite image of an aerial view of the house[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Scene Classification for Remote Sensing Image
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png[0m
Processed Scene Classification, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png, Output Scene: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png has 70.56% probability being Church and 23.43% probability being Farmland.

Observation: [33;1m[1;3m/root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png has 70.56% probability being Church and 23.43% probability being Farmland.[0m
Thought:[32;1m[1;3mAI: The image you provided is a satellite image showing an aerial view of a house. It has been classified with a 70.56% probability as a Church and a 23.43% probability as Farmland. 

As for the image quality, I will need to use a tool to assess the clarity of the image. Let me do that for you.

Thought: Do I need to use a tool? Yes
Action: Edge Detection On Image
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/train/A/train_002542.png[0m

[1m> Finished chain.[0m
  Turn 6 (Assistant): âœ— é”™è¯¯
    å®é™…: ['ImageCaptioning', 'SceneClassification']
    æœŸæœ›: []

[æ ·æœ¬ 2/3] ID=2
  Turn 1 (User): å˜¿ï¼Œè¿™ä¸ªåŠ©æ‰‹èƒ½å¸®æˆ‘çœ‹çœ‹è¿™å¼ é¥æ„Ÿå›¾å—ï¼Ÿ...

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png, Output Text: A satellite image of a road with a car parked on it

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png, Output Text: A satellite image of a road with a car parked on it


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Get Photo Description
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png[0m
Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png, Output Text: A satellite image of a road with a car parked on it

Processed ImageCaptioning, Input Image: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png, Output Text: A satellite image of a road with a car parked on it

Observation: [36;1m[1;3mA satellite image of a road with a car parked on it[0m
Thought:[32;1m[1;3mThought: Do I need to use a tool? No
AI: The image you provided is a satellite image of a road with a car parked on it. How can I assist you further with this image?[0m

[1m> Finished chain.[0m
  Turn 3 (User): è¿™ä¸ªåœ°æ–¹æœ€è¿‘æœ‰ä»€ä¹ˆæ–°ä¸œè¥¿æ²¡ï¼Ÿ...


[1m> Entering new AgentExecutor chain...[0m
[32;1m[1;3mThought: Do I need to use a tool? Yes
Action: Change Detection On Image Pair
Action Input: /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png,/root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/val_000392.png,identify any changes[0mChange detection completed. Changed area: 0.00% (0/65536 pixels). Result saved to /root/autodl-tmp/datasets/LEVIR-MCI-dataset/images/val/A/3109_change_detection_val.png

Observation: /root/miniconda3/envs/mmchange/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/torch/nn/functional.py:3631: UserWarning: Default upsampling behavior when mode=bilinear is changed to align_corners=False since 0.4.0. Please specify align_corners=True if the old behavior is desired. See the documentation of nn.Upsample for details.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
/root/miniconda3/envs/mmchange/lib/python3.8/site-packages/transformers/generation/utils.py:1273: UserWarning: Neither `max_length` nor `max_new_tokens` has been set, `max_length` will default to 20 (`generation_config.max_length`). Controlling `max_length` via the config is deprecated and `max_length` will be removed from the config in v5 of Transformers -- we recommend using `max_new_tokens` to control the maximum length of the generation.
  warnings.warn(
HTTP Request: POST https://api.chatanywhere.tech/chat/completions "HTTP/1.1 200 OK"
